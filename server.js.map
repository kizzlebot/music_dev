{"version":3,"sources":["webpack:///webpack/bootstrap 7e97faadff7fd07a1754","webpack:///../app.js","webpack:///../~/webpack/buildin/module.js","webpack:///external \"babel-register\"","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"serve-favicon\"","webpack:///external \"morgan\"","webpack:///external \"cookie-parser\"","webpack:///external \"body-parser\"","webpack:///external \"compression\"","webpack:///external \"method-override\"","webpack:///external \"passport\"","webpack:///external \"express-validator\"","webpack:///external \"express-flash\"","webpack:///external \"express-session\"","webpack:///external \"connect-mongo/es5\"","webpack:///external \"mongoose\"","webpack:///external \"lusca\"","webpack:///../server/config/passport_config.js","webpack:///external \"url\"","webpack:///external \"lodash\"","webpack:///external \"passport-local\"","webpack:///external \"passport-facebook\"","webpack:///external \"passport-github\"","webpack:///external \"passport-google-oauth\"","webpack:///external \"passport-linkedin-oauth2\"","webpack:///../server/config/lastfm_strategy.js","webpack:///external \"util\"","webpack:///external \"passport-strategy\"","webpack:///external \"lastfmapi\"","webpack:///external \"passport-soundcloud\"","webpack:///../server/models/User.js","webpack:///external \"bcrypt-nodejs\"","webpack:///external \"crypto\"","webpack:///../server/controllers/index.js","webpack:///external \"fs\"","webpack:///../server/controllers/home.js","webpack:///../server/controllers/user.js","webpack:///external \"async\"","webpack:///external \"nodemailer\""],"names":[],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 7e97faadff7fd07a1754\n **/","require(\"babel-register\");\n\nvar express = require('express');\nvar path = require('path');\nvar favicon = require('serve-favicon');\nvar logger = require('morgan');\nvar cookieParser = require('cookie-parser');\nvar bodyParser = require('body-parser');\nvar compress = require('compression');\nvar methodOverride = require('method-override');\nvar passport = require('passport');\nvar expressValidator = require('express-validator');\nvar flash = require('express-flash');\nvar session = require('express-session');\nvar MongoStore = require('connect-mongo/es5')(session);\nvar mongoose = require('mongoose');\nvar lusca = require('lusca');\n\nvar app = express();\n\n\n\n\n\n\n\n\n/* ----------------------------------------------------\n * ----------------------------------------------------\n *                    Middleware\n * ---------------------------------------------------\n * --------------------------------------------------- */\n\n\n/**\n * Connect to MongoDB.\n */\nmongoose.connect(process.env.MONGODB || process.env.MONGOLAB_URI);\nmongoose.connection.on('error', function() {\n  console.log('MongoDB Connection Error. Please make sure that MongoDB is running.');\n  process.exit(1);\n});\n\n\n\n\napp.set('port', process.env.PORT || '3000');\n\n// view engine setup\napp.set('views', path.join(__dirname, 'server', 'views'));\napp.set('view engine', 'jade');\n\napp.use(compress());\n\n// Skip logging if test environment\napp.use(logger('dev', { skip: (req, res) => (process.env.NODE_ENV == 'test') }));\n\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(expressValidator());\napp.use(methodOverride());\napp.use(cookieParser());\napp.use(session({\n  resave: true,\n  saveUninitialized: true,\n  secret: process.env.SESSION_SECRET,\n  store: new MongoStore({\n    url: process.env.MONGODB || process.env.MONGOLAB_URI,\n    autoReconnect: true\n  })\n}));\napp.use(passport.initialize());\napp.use(passport.session());\napp.use(flash());\napp.use((req, res, next) => {\n  (req.path === '/api/upload') ? next() : lusca.csrf()(req, res, next);\n});\napp.use(lusca.xframe('SAMEORIGIN'));\napp.use(lusca.xssProtection(true));\n\n\napp.use((req, res, next) => {\n  res.locals.user = req.user;\n  if (/api/i.test(req.path)) req.session.returnTo = req.path;\n  if(res.locals._csrf) {\n    res.cookie('csrf', res.locals._csrf);\n    res.set('CSRF', res.locals._csrf);\n  }\n  next();\n});\napp.use(express.static(path.join(__dirname, 'public')));\n\n\n\nvar passportConfig = require('./server/config/passport_config');\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* ----------------------------------------------------\n * ----------------------------------------------------\n *                    Routes\n * ---------------------------------------------------\n * --------------------------------------------------- */\n\nvar routes = require('./server/controllers/index');\nvar User = require('./server/models/User');\n\n\napp.get('/', routes.home.index);\n\napp.get('/login', routes.user.getLogin);\napp.get('/signup', routes.user.getSignup);\napp.get('/logout', routes.user.logout);\napp.get('/contact', routes.user.getContact);\napp.get('/forgot', routes.user.getForgot);\napp.get('/reset/:token', routes.user.getReset);\napp.get('/account', passportConfig.isAuthenticated, routes.user.getAccount);\napp.get('/account/unlink/:provider', passportConfig.isAuthenticated, routes.user.getOauthUnlink);\n\n\napp.post('/login', routes.user.postLogin);\napp.post('/signup', routes.user.postSignup);\napp.post('/contact', routes.user.postContact);\napp.post('/forgot', routes.user.postForgot);\napp.post('/reset/:token', routes.user.postReset);\napp.post('/signup', routes.user.postSignup);\napp.post('/reset/:token', routes.user.postReset);\napp.post('/account/profile', passportConfig.isAuthenticated, routes.user.postUpdateProfile);\napp.post('/account/password', passportConfig.isAuthenticated, routes.user.postUpdatePassword);\napp.post('/account/delete', passportConfig.isAuthenticated, routes.user.postDeleteAccount);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\napp.get('/auth/soundcloud', passportConfig.isAuthenticated, passportConfig.hasAPI('soundcloud'), passport.authenticate('soundcloud'));\napp.get('/auth/soundcloud/callback', function(req, res) {\n  passport.authenticate('soundcloud', { failureRedirect:'/login' }, function(err, user, sesh){\n    res.redirect(req.session.returnTo || '/');\n  })(req, {} );\n});\n\n\napp.get('/auth/lastfm', passportConfig.isAuthenticated, passportConfig.hasAPI('lastfm'), passport.authenticate('lastfm'));\napp.get('/auth/lastfm/callback', function(req, res, next){\n  passport.authenticate('lastfm', { failureRedirect:'/login' }, function(err, user, sesh){\n    res.redirect(req.session.returnTo || '/');\n  })(req, {} );\n});\n\n\napp.get('/auth/facebook', passport.authenticate('facebook', { scope: ['email', 'user_location'] }));\napp.get('/auth/facebook/callback', passport.authenticate('facebook', { failureRedirect: '/login' }), function(req, res) {\n  res.redirect(req.session.returnTo || '/');\n});\n\n\napp.get('/auth/github', passport.authenticate('github'));\napp.get('/auth/github/callback', passport.authenticate('github', { failureRedirect: '/login' }), function(req, res) {\n  res.redirect(req.session.returnTo || '/');\n});\n\n\napp.get('/auth/google', passport.authenticate('google', { scope: 'profile email' }));\napp.get('/auth/google/callback', passport.authenticate('google', { failureRedirect: '/login' }), function(req, res) {\n  res.redirect(req.session.returnTo || '/');\n});\n\n\napp.get('/auth/linkedin', passport.authenticate('linkedin', { state: 'SOME STATE' }));\napp.get('/auth/linkedin/callback', passport.authenticate('linkedin', { failureRedirect: '/login' }), function(req, res) {\n  res.redirect(req.session.returnTo || '/');\n});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*************************\n * error handlers\n **************************/\n\n/* * development error handlers */\nif (app.get('env') === 'development') {\n  app.use(function(err, req, res, next) {\n    res.status(err.status || 500);\n    res.render('error', {\n      message: err.message,\n      error: err\n    });\n  });\n}\n\n\n/* production error handler\n *  - No stacktraces shown to user */\napp.use(function(err, req, res, next) {\n  // res.status(err.status || 500);\n  res.render('error', {\n    message: err.message,\n    error: {}\n  });\n});\n\n\n\n  if (module.hot) {\n    console.log(\"[HMR] Waiting for server-side updates\");\n\n    module.hot.accept(\"components/routes\", () => {\n      routes = require(\"components/routes\");\n    });\n\n    module.hot.addStatusHandler((status) => {\n      if (status === \"abort\") {\n        setTimeout(() => process.exit(0), 0);\n      }\n    });\n  }\n\n\n\n// If file was loaded directly (ie via npm start) then start the server and export it.\n// Otherwise if 'required' from another file export express app without starting server\nmodule.exports = (require.main == module) ? app.listen(app.get('port'), () => console.log('Example app listening at port %s', app.get('port'))) : app;\n\n\n\n/** WEBPACK FOOTER **\n ** ../app.js\n **/","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tmodule.children = [];\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/webpack/buildin/module.js\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"babel-register\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"babel-register\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"serve-favicon\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"serve-favicon\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"morgan\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"morgan\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = require(\"cookie-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cookie-parser\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"body-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"body-parser\"\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = require(\"compression\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"compression\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"method-override\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"method-override\"\n ** module id = 11\n ** module chunks = 0\n **/","module.exports = require(\"passport\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport\"\n ** module id = 12\n ** module chunks = 0\n **/","module.exports = require(\"express-validator\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-validator\"\n ** module id = 13\n ** module chunks = 0\n **/","module.exports = require(\"express-flash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-flash\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"express-session\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-session\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"connect-mongo/es5\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"connect-mongo/es5\"\n ** module id = 16\n ** module chunks = 0\n **/","module.exports = require(\"mongoose\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mongoose\"\n ** module id = 17\n ** module chunks = 0\n **/","module.exports = require(\"lusca\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lusca\"\n ** module id = 18\n ** module chunks = 0\n **/","var uri = require('url');\nvar _ = require('lodash');\nvar passport = require('passport');\nvar LocalStrategy = require('passport-local').Strategy;\nvar FacebookStrategy = require('passport-facebook').Strategy;\nvar GitHubStrategy = require('passport-github').Strategy;\nvar GoogleStrategy = require('passport-google-oauth').OAuth2Strategy;\nvar LinkedInStrategy = require('passport-linkedin-oauth2').Strategy;\nvar LastFmStrategy = require('./lastfm_strategy');\nvar SoundCloudTokenStrategy = require('passport-soundcloud').Strategy;\n\nvar User = require('../models/User');\n\n\n\n\npassport.serializeUser(function(user, done) {\n  done(null, user.id);\n});\n\npassport.deserializeUser(function(id, done) {\n  User.findById(id, function(err, user) {\n    done(err, user);\n  });\n});\n\nvar {LASTFM_KEY, LASTFM_SECRET} = process.env;\nvar LastfmAPI = require('lastfmapi');\n\n\nvar _lastfm = new LastfmAPI({\n  'api_key': LASTFM_KEY,\n  'secret':LASTFM_SECRET\n});\n\n\n\n\n\n\n\n\npassport.use(new SoundCloudTokenStrategy({\n  clientID: process.env.SOUNDCLOUD_ID,\n  clientSecret: process.env.SOUNDCLOUD_SECRET,\n  callbackURL: `http://${process.env.HOSTNAME || 'localhost'}:${process.env.PORT || 3000}/auth/soundcloud/callback`,\n  passReqToCallback: true\n}, function(req, accessToken, refreshToken, profile, done){\n\n  if (req.user){\n\n    User.findById(req.user.id, (err, user) => {\n      if (err) return done(err);\n\n\n      // check if soundcloud oauth_token already present for this user\n\n      if (user.soundcloud && _.find(req.user.tokens, {type:'soundcloud'})) {\n        return done(err, user)\n      }\n      else {\n        user.tokens.push({type:'soundcloud', accessToken, refreshToken, profile});\n        user.soundcloud = profile.id;\n\n        user.save(function(err){\n          if (err) return done(err);\n          req.flash('success', {msg:\"Soundcloud authentication success\"});\n          return done(err, user);\n        })\n      }\n    });\n  }\n  else{\n    req.flash('errors', {msg: 'Need to be logged in first'});\n    done(null, false, {message: 'Need to be logged in first'});\n  }\n}));\n\n\n\n\n\n/**\n * LocalStrategy\n * Sign in using Email and Password.\n */\npassport.use(new LocalStrategy({ usernameField: 'email' }, function(email, password, done) {\n  // Try to find user by email\n  User.findOne({ email: email.toLowerCase() }, function(err, user) {\n\n    // if email not found\n    if (!user) {\n      return done(null, false, {message: `Email ${email} not found.` });\n    }\n\n    // Check if password given matches value in db\n    user.comparePassword(password, function(err, isMatch) {\n      return (isMatch) ? done(null, user) : done(null, false, { message: 'Invalid email or password.' });\n    });\n  });\n}));\n\n\n\n\npassport.use(new LastFmStrategy({\n  'api_key': LASTFM_KEY,\n  'secret': LASTFM_SECRET\n}, function(req, sessionKey, done) {\n  // Find/Update user's lastfm session\n\n  // If user logged in\n  if (req.user){\n    User.findById(req.user.id, (err, user) => {\n      if (err) return done(err);\n\n      user.tokens.push({type:'lastfm', username:sessionKey.username, key:sessionKey.key });\n      user.lastfm = sessionKey.key;\n\n      user.save(function(err){\n        if (err) return done(err);\n        req.flash('success', {msg:\"Last.fm authentication success\"});\n        return done(err, user, sessionKey);\n      })\n    });\n  }\n  else{\n    User.findOne({lastfm:sessionKey.key}, function(err, existing){\n      if (existing){\n        req.flash('errors', { msg: 'There is already a Lastfm account that belongs to you. Sign in with that account or delete it, then link it with your current account.' });\n        done(err, existing);\n      }\n      else{\n        done(err);\n      }\n    })\n  }\n}));\n\n\n\n\n/**\n * Sign in with Facebook.\n */\npassport.use(new FacebookStrategy({\n  clientID: process.env.FACEBOOK_ID,\n  clientSecret: process.env.FACEBOOK_SECRET,\n  callbackURL: '/auth/facebook/callback',\n  profileFields: ['name', 'email', 'link', 'locale', 'timezone'],\n  passReqToCallback: true\n}, function(req, accessToken, refreshToken, profile, done) {\n  if (req.user) {\n    User.findOne({ facebook: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        req.flash('errors', { msg: 'There is already a Facebook account that belongs to you. Sign in with that account or delete it, then link it with your current account.' });\n        done(err);\n      }\n      else {\n        User.findById(req.user.id, function(err, user) {\n          user.facebook = profile.id;\n          user.tokens.push({ kind: 'facebook', accessToken: accessToken });\n          user.profile.name = user.profile.name || profile.displayName;\n          user.profile.gender = user.profile.gender || profile._json.gender;\n          user.profile.picture = user.profile.picture || 'https://graph.facebook.com/' + profile.id + '/picture?type=large';\n          user.save(function(err) {\n            req.flash('info', { msg: 'Facebook account has been linked.' });\n            done(err, user);\n          });\n        });\n      }\n    });\n  }\n  else {\n    User.findOne({ facebook: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        return done(null, existingUser);\n      }\n      User.findOne({ email: profile._json.email }, function(err, existingEmailUser) {\n        if (existingEmailUser) {\n          req.flash('errors', { msg: 'There is already an account using this email address. Sign in to that account and link it with Facebook manually from Account Settings.' });\n          done(err);\n        }\n        else {\n          var user = new User();\n          user.email = profile._json.email;\n          user.facebook = profile.id;\n          user.tokens.push({ kind: 'facebook', accessToken: accessToken });\n          user.profile.name = profile.displayName;\n          user.profile.gender = profile._json.gender;\n          user.profile.picture = 'https://graph.facebook.com/' + profile.id + '/picture?type=large';\n          user.profile.location = (profile._json.location) ? profile._json.location.name : '';\n          user.save(function(err) {\n            done(err, user);\n          });\n        }\n      });\n    });\n  }\n}));\n\n\n\n\n/**\n * GitHub.\n */\npassport.use(new GitHubStrategy({\n  clientID: process.env.GITHUB_ID,\n  clientSecret: process.env.GITHUB_SECRET,\n  callbackURL: '/auth/github/callback',\n  passReqToCallback: true\n}, function(req, accessToken, refreshToken, profile, done) {\n  if (req.user) {\n    User.findOne({ github: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        req.flash('errors', { msg: 'There is already a GitHub account that belongs to you. Sign in with that account or delete it, then link it with your current account.' });\n        done(err);\n      }\n      else {\n        User.findById(req.user.id, function(err, user) {\n          user.github = profile.id;\n          user.tokens.push({ kind: 'github', accessToken: accessToken });\n          user.profile.name = user.profile.name || profile.displayName;\n          user.profile.picture = user.profile.picture || profile._json.avatar_url;\n          user.profile.location = user.profile.location || profile._json.location;\n          user.profile.website = user.profile.website || profile._json.blog;\n          user.save(function(err) {\n            req.flash('info', { msg: 'GitHub account has been linked.' });\n            done(err, user);\n          });\n        });\n      }\n    });\n  }\n  else {\n    User.findOne({ github: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        return done(null, existingUser);\n      }\n      User.findOne({ email: profile._json.email }, function(err, existingEmailUser) {\n        if (existingEmailUser) {\n          req.flash('errors', { msg: 'There is already an account using this email address. Sign in to that account and link it with GitHub manually from Account Settings.' });\n          done(err);\n        } else {\n          var user = new User();\n          user.email = profile._json.email;\n          user.github = profile.id;\n          user.tokens.push({ kind: 'github', accessToken: accessToken });\n          user.profile.name = profile.displayName;\n          user.profile.picture = profile._json.avatar_url;\n          user.profile.location = profile._json.location;\n          user.profile.website = profile._json.blog;\n          user.save(function(err) {\n            done(err, user);\n          });\n        }\n      });\n    });\n  }\n}));\n\n\n\n\n/**\n * Google.\n */\npassport.use(new GoogleStrategy({\n  clientID: process.env.GOOGLE_ID,\n  clientSecret: process.env.GOOGLE_SECRET,\n  callbackURL: '/auth/google/callback',\n  passReqToCallback: true\n}, function(req, accessToken, refreshToken, profile, done) {\n  if (req.user) {\n    User.findOne({ google: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        req.flash('errors', { msg: 'There is already a Google account that belongs to you. Sign in with that account or delete it, then link it with your current account.' });\n        done(err);\n      } else {\n        User.findById(req.user.id, function(err, user) {\n          user.google = profile.id;\n          user.tokens.push({ kind: 'google', accessToken: accessToken });\n          user.profile.name = user.profile.name || profile.displayName;\n          user.profile.gender = user.profile.gender || profile._json.gender;\n          user.profile.picture = user.profile.picture || profile._json.image.url;\n          user.save(function(err) {\n            req.flash('info', { msg: 'Google account has been linked.' });\n            done(err, user);\n          });\n        });\n      }\n    });\n  } else {\n    User.findOne({ google: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        return done(null, existingUser);\n      }\n      User.findOne({ email: profile.emails[0].value }, function(err, existingEmailUser) {\n        if (existingEmailUser) {\n          req.flash('errors', { msg: 'There is already an account using this email address. Sign in to that account and link it with Google manually from Account Settings.' });\n          done(err);\n        } else {\n          var user = new User();\n          user.email = profile.emails[0].value;\n          user.google = profile.id;\n          user.tokens.push({ kind: 'google', accessToken: accessToken });\n          user.profile.name = profile.displayName;\n          user.profile.gender = profile._json.gender;\n          user.profile.picture = profile._json.image.url;\n          user.save(function(err) {\n            done(err, user);\n          });\n        }\n      });\n    });\n  }\n}));\n\n\n/*\n *  LinkedIn\n */\npassport.use(new LinkedInStrategy({\n  clientID: process.env.LINKEDIN_ID,\n  clientSecret: process.env.LINKEDIN_SECRET,\n  callbackURL: 'http://127.0.0.1/auth/linkedin/callback',\n  scope: ['r_basicprofile', 'r_emailaddress'],\n  passReqToCallback: true\n}, function(req, accessToken, refreshToken, profile, done) {\n  if (req.user) {\n    User.findOne({ linkedin: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        req.flash('errors', { msg: 'There is already a LinkedIn account that belongs to you. Sign in with that account or delete it, then link it with your current account.' });\n        done(err);\n      } else {\n        User.findById(req.user.id, function(err, user) {\n          user.linkedin = profile.id;\n          user.tokens.push({ kind: 'linkedin', accessToken: accessToken });\n          user.profile.name = user.profile.name || profile.displayName;\n          user.profile.location = user.profile.location || profile._json.location.name;\n          user.profile.picture = user.profile.picture || profile._json.pictureUrl;\n          user.profile.website = user.profile.website || profile._json.publicProfileUrl;\n          user.save(function(err) {\n            req.flash('info', { msg: 'LinkedIn account has been linked.' });\n            done(err, user);\n          });\n        });\n      }\n    });\n  } else {\n    User.findOne({ linkedin: profile.id }, function(err, existingUser) {\n      if (existingUser) {\n        return done(null, existingUser);\n      }\n      User.findOne({ email: profile._json.emailAddress }, function(err, existingEmailUser) {\n        if (existingEmailUser) {\n          req.flash('errors', { msg: 'There is already an account using this email address. Sign in to that account and link it with LinkedIn manually from Account Settings.' });\n          done(err);\n        } else {\n          var user = new User();\n          user.linkedin = profile.id;\n          user.tokens.push({ kind: 'linkedin', accessToken: accessToken });\n          user.email = profile._json.emailAddress;\n          user.profile.name = profile.displayName;\n          user.profile.location = profile._json.location.name;\n          user.profile.picture = profile._json.pictureUrl;\n          user.profile.website = profile._json.publicProfileUrl;\n          user.save(function(err) {\n            done(err, user);\n          });\n        }\n      });\n    });\n  }\n}));\n\n\n\n\n\n\nexports.hasAPI = function(api_name){\n  return function(req, res, next){\n    if (req.user[api_name]){\n      res.redirect('/');\n    }\n    else{\n      next();\n    }\n  }\n}\n\n\n/**\n * Login Required middleware.\n */\nexports.isAuthenticated = (req, res, next) => {\n  if (req.isAuthenticated()){\n    req.session.returnTo = null;\n    next();\n  }\n  else{\n    req.session.returnTo = req.path ;\n    res.redirect('/login');\n  }\n}\n\n\n\n/**\n * Authorization Required middleware.\n */\nexports.isAuthorized = (req, res, next) => {\n  var provider = req.path.split('/').slice(-1)[0];\n  return (_.find(req.user.tokens, { kind: provider })) ? next() : res.redirect(`/auth/${provider}`);\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ../server/config/passport_config.js\n **/","module.exports = require(\"url\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"url\"\n ** module id = 20\n ** module chunks = 0\n **/","module.exports = require(\"lodash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lodash\"\n ** module id = 21\n ** module chunks = 0\n **/","module.exports = require(\"passport-local\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-local\"\n ** module id = 22\n ** module chunks = 0\n **/","module.exports = require(\"passport-facebook\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-facebook\"\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = require(\"passport-github\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-github\"\n ** module id = 24\n ** module chunks = 0\n **/","module.exports = require(\"passport-google-oauth\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-google-oauth\"\n ** module id = 25\n ** module chunks = 0\n **/","module.exports = require(\"passport-linkedin-oauth2\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-linkedin-oauth2\"\n ** module id = 26\n ** module chunks = 0\n **/","var util = require('util');\nvar Strategy = require('passport-strategy');\nvar LastfmAPI = require('lastfmapi');\n\n\nfunction LastfmStrategy(options, verify){\n\tif (!options.api_key)  { throw new TypeError('LastfmStrategy requires a api_key option'); }\n\tif (!verify)  { throw new TypeError('LastfmStrategy requires verify callback'); }\n\n\tStrategy.call(this);\n\n\tthis.name = 'lastfm';\n\tthis.api_key = options.api_key;\n\tthis.secret = options.secret;\n\n\n\tthis._verify = verify;\n\tthis._lastfm = new LastfmAPI({\n\t\t'api_key': this.api_key,\n\t\t'secret':this.secret\n\t});\n}\n\n\nLastfmStrategy.prototype.authenticate = function(req, options){\n\tvar self = this;\n\tvar authUrl = self._lastfm.getAuthenticationUrl() + `&cb=http://localhost:${process.env.PORT || 3000}/auth/lastfm/callback`;\n\n\n\tif (req.query && req.query.token){\n    var token = req.query.token;\n\n\t\tthis._lastfm.authenticate(req.query.token, function(er, session){\n\t\t\tif (!session) self.fail(session, 403);\n\n\n\t\t\t// Build the done() function called by the verify function\n\t\t\tfunction verified(err, user, session){\n\n        if (err)  self.error(err);\n        else if (!user) self.fail(user, session);\n        else self.success(user, session);\n\t\t\t}\n\n\t\t\tself._verify(req, session, verified);\n\t\t});\n\t}\n\telse{\n\t\tself.redirect(authUrl);\n\t}\n}\n\n\n\n\n\n\n\nutil.inherits(LastfmStrategy, Strategy);\n\n\n\nmodule.exports = exports = LastfmStrategy;\n\n\n/** WEBPACK FOOTER **\n ** ../server/config/lastfm_strategy.js\n **/","module.exports = require(\"util\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"util\"\n ** module id = 28\n ** module chunks = 0\n **/","module.exports = require(\"passport-strategy\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-strategy\"\n ** module id = 29\n ** module chunks = 0\n **/","module.exports = require(\"lastfmapi\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lastfmapi\"\n ** module id = 30\n ** module chunks = 0\n **/","module.exports = require(\"passport-soundcloud\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"passport-soundcloud\"\n ** module id = 31\n ** module chunks = 0\n **/","var bcrypt = require('bcrypt-nodejs');\nvar crypto = require('crypto');\nvar mongoose = require('mongoose');\n\nvar userSchema = new mongoose.Schema({\n  email: { type: String, unique: true, lowercase: true },\n  password: String,\n\n  facebook: String,\n\n  google: String,\n  github: String,\n\n  linkedin: String,\n  lastfm: String,\n  soundcloud:String,\n  tokens: Array,\n\n  profile: {\n    name: { type: String, default: '' },\n    gender: { type: String, default: '' },\n    location: { type: String, default: '' },\n    website: { type: String, default: '' },\n    picture: { type: String, default: '' }\n  },\n\n  resetPasswordToken: String,\n  resetPasswordExpires: Date\n});\n\n/**\n * Password hash middleware.\n */\nuserSchema.pre('save', function(next){\n  var user = this;\n  if (!user.isModified('password')) return next();\n  bcrypt.genSalt(10, (err, salt) => {\n    if (err) return next(err);\n\n    bcrypt.hash(user.password, salt, null, (err, hash) => {\n      if (err) return next(err);\n      user.password = hash;\n      next();\n    });\n  });\n});\n\n\n/**\n * Helper method for validating user's password.\n */\nuserSchema.methods.comparePassword = function(candidatePassword, cb) {\n  bcrypt.compare(candidatePassword, this.password, function(err, isMatch) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, isMatch);\n  });\n};\n\n\n\n\n/**\n * Helper method for getting user's gravatar.\n */\nuserSchema.methods.gravatar = function(size) {\n  if (!size) {\n    size = 200;\n  }\n  if (!this.email) {\n    return 'https://gravatar.com/avatar/?s=' + size + '&d=retro';\n  }\n  var md5 = crypto.createHash('md5').update(this.email).digest('hex');\n  return 'https://gravatar.com/avatar/' + md5 + '?s=' + size + '&d=retro';\n};\n\nmodule.exports = mongoose.model('User', userSchema);\n\n\n\n/** WEBPACK FOOTER **\n ** ../server/models/User.js\n **/","module.exports = require(\"bcrypt-nodejs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"bcrypt-nodejs\"\n ** module id = 33\n ** module chunks = 0\n **/","module.exports = require(\"crypto\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"crypto\"\n ** module id = 34\n ** module chunks = 0\n **/","var fs = require('fs');\nvar path = require('path');\n\nvar dirs = path.dirname(module.filename);\nvar currFilename = module.filename.replace(`${dirs}/`, '');\n\n\n\n/**\n * Reads dir content names as array and reduces it, excluding elements for which the valid callback\n * returns false for.\n * @param  {string} dirname   The directory to look through\n * @param  {fs.State} valid   Called with `stat` object as argument\n * @return {Object}           Key-value of filenames\n */\n/*\nfunction getPathInfo(dirname = __dirname, valid){\n  return  fs.readdirSync(dirname)\n            .reduce( (prev, curr) => {\n              // if valid says no then skip\n\n              var stat = fs.statSync(path.join(dirname, curr));\n              if (!valid(stat) || curr == currFilename) return prev;\n\n              // otherwise add to prev and return prev\n              var name = curr.replace(/(.*)\\.(.*?)$/, \"$1\");\n\n              prev[name] = path.join(dirname, curr);\n              return prev;\n            }, {});\n}\nfunction getFiles(dirname){\n  return getPathInfo(dirname, (stat) => stat.isFile());\n}\n\nfunction getDirectories(dirname){\n  return getPathInfo(dirname, (stat) => stat.isDirectory());\n}\n\n\nvar toExport = {};\nvar files = getFiles(__dirname);\n\nObject.keys(files).forEach((k) => {\n  toExport[k] = require(files[k]);\n})\n*/\n\nvar home = require('./home');\nvar user = require('./user');\n\n\nvar toExport = {\n  home:home,\n  user:user\n};\n\nmodule.exports = toExport;\n\n\n\n/** WEBPACK FOOTER **\n ** ../server/controllers/index.js\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 36\n ** module chunks = 0\n **/","var express = require('express');\nvar router = express.Router();\n\nvar LastfmAPI = require('lastfmapi');\n\n\n// var key = '7b3fb0efdb5cd66aebcab7230be6aeb6';\n\nvar _lastfm = new LastfmAPI({\n  'api_key': process.env.LASTFM_KEY,\n  'secret':process.env.LASTFM_SECRET\n});\n\n\n\n// module.exports = _lastfm;\n\nexports.index = function(req, res, next){\n\tif (req.users){\n\t\tvar session = req.user.tokens.reduce((prev, curr) => {\n\t\t\tif (prev) return prev;\n\t\t\tif (curr.type == 'lastfm') return curr;\n\t\t\treturn prev;\n\t\t}, null);\n\t\tif (session){\n\t\t\t_lastfm.setSessionCredentials(session.username, session.key);\n\t\t\t_lastfm.user.getInfo((err, data) => res.render('index', {title:'expressf', lastfm:data}))\n\t\t}\n\t}\n\telse res.render('index', {title:'express'});\n\n\n\n}\n\n\n/** WEBPACK FOOTER **\n ** ../server/controllers/home.js\n **/","var _ = require('lodash');\nvar async = require('async');\nvar crypto = require('crypto');\nvar nodemailer = require(\"nodemailer\");\nvar transporter = nodemailer.createTransport({\n  service: 'SendGrid',\n  auth: {\n    user: process.env.SENDGRID_USER,\n    pass: process.env.SENDGRID_PASSWORD\n  }\n});\n\nvar passport = require('passport');\nvar User = require('../models/User');\n\n/**\n * GET /login\n * Login page.\n */\nexports.getLogin = function(req, res) {\n  if (req.user) return res.redirect('/');\n\n  res.render('account/login', {\n    title: 'Login to Account'\n  });\n};\n\n\n/**\n * GET /contact\n * Contact form page.\n */\nexports.getContact = function(req, res) {\n  res.render('contact', {\n    title: 'Contact'\n  });\n};\n\n\nexports.getSignup = function(req, res) {\n  if (req.user) {\n    return res.status(302).redirect('/');\n  }\n  res.render('account/signup', {\n    title: 'Create Account'\n  });\n};\n\n\n/**\n * GET /account\n * Profile page.\n */\nexports.getAccount = function(req, res) {\n  res.render('account/profile', {\n    title: 'Account Management'\n  });\n};\n\n\n/**\n * GET /forgot\n * Forgot Password page.\n */\nexports.getForgot = function(req, res) {\n  if (req.isAuthenticated()) {\n    return res.redirect('/');\n  }\n  res.render('account/forgot', {\n    title: 'Forgot Password'\n  });\n};\n\n\n/**\n * GET /account/unlink/:provider\n * Unlink OAuth provider.\n */\nexports.getOauthUnlink = function(req, res, next) {\n  var provider = req.params.provider;\n  User.findById(req.user.id, function(err, user) {\n    if (err) {\n      return next(err);\n    }\n    user[provider] = undefined;\n    user.tokens = _.reject(user.tokens, function(token) { return token.kind === provider; });\n    user.save(function(err) {\n      if (err) return next(err);\n      req.flash('info', { msg: provider + ' account has been unlinked.' });\n      res.redirect('/account');\n    });\n  });\n};\n\n\n/**\n * GET /reset/:token\n * Reset Password page.\n */\nexports.getReset = function(req, res, next) {\n  if (req.isAuthenticated()) {\n    return res.redirect('/');\n  }\n  User\n    .findOne({ passwordResetToken: req.params.token })\n    .where('passwordResetExpires').gt(Date.now())\n    .exec(function(err, user) {\n      if (err) {\n        return next(err);\n      }\n      if (!user) {\n        req.flash('errors', { msg: 'Password reset token is invalid or has expired.' });\n        return res.redirect('/forgot');\n      }\n      res.render('account/reset', {\n        title: 'Password Reset'\n      });\n    });\n};\n\n\n/**\n * POST /login\n * Sign in using email and password.\n */\nexports.postLogin = function(req, res, next) {\n  req.assert('email', 'Email is not valid').isEmail();\n  req.assert('password', 'Password cannot be blank').notEmpty();\n  req.sanitize('email').normalizeEmail();\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.status(401).render('account/login');\n  }\n\n  passport.authenticate('local', function(err, user, info) {\n    if (err) return next(err);\n\n    else if (!user) {\n      req.flash('errors', { msg: info.message });\n      return res.status(401).render('account/login')\n    }\n\n    req.logIn(user, function(err) {\n      if (err) return next(err);\n\n      req.flash('success', { msg: 'Success! You are logged in.' });\n      res.status(202).redirect(req.session.returnTo || '/');\n    });\n  })(req, res, next);\n};\n\n/**\n * GET /logout\n * Log out.\n */\nexports.logout = function(req, res) {\n  req.logout();\n  res.redirect('/');\n};\n\n\n\n\nexports.postContact = function(req, res) {\n  req.assert('name', 'Name cannot be blank').notEmpty();\n  req.assert('email', 'Email is not valid').isEmail();\n  req.assert('message', 'Message cannot be blank').notEmpty();\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.redirect('/contact');\n  }\n\n  var from = req.body.email;\n  var name = req.body.name;\n  var body = req.body.message;\n  var to = 'your@email.com';\n  var subject = 'Contact Form | Hackathon Starter';\n\n  var mailOptions = {\n    to: to,\n    from: from,\n    subject: subject,\n    text: body\n  };\n\n  transporter.sendMail(mailOptions, function(err) {\n    if (err) {\n      req.flash('errors', { msg: err.message });\n      return res.redirect('/contact');\n    }\n    req.flash('success', { msg: 'Email has been sent successfully!' });\n    res.redirect('/contact');\n  });\n};\n\n/**\n * POST /signup\n * Create a new local account.\n */\nexports.postSignup = function(req, res, next) {\n  req.assert('email', 'Email is not valid').isEmail();\n  req.assert('password', 'Password must be at least 4 characters long').len(4);\n  req.assert('confirmPassword', 'Passwords do not match').equals(req.body.password);\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.redirect('/signup');\n  }\n\n  var user = new User({\n    email: req.body.email,\n    password: req.body.password\n  });\n\n  User.findOne({ email: req.body.email }, function(err, existingUser) {\n    if (existingUser) {\n      // req.flash('errors', { msg: 'Account with that email address already exists.' });\n      return res.render('/account/signup', { msg: 'Account with that email address already exists'});\n    }\n    user.save(function(err) {\n      if (err) {\n        return next(err);\n      }\n      req.logIn(user, function(err) {\n        if (err) {\n          return next(err);\n        }\n        res.redirect('/');\n      });\n    });\n  });\n};\n\n\n\n\n\n\n/**\n * POST /account/profile\n * Update profile information.\n */\nexports.postUpdateProfile = function(req, res, next) {\n  User.findById(req.user.id, function(err, user) {\n    if (err) {\n      return next(err);\n    }\n    user.email = req.body.email || '';\n    user.profile.name = req.body.name || '';\n    user.profile.gender = req.body.gender || '';\n    user.profile.location = req.body.location || '';\n    user.profile.website = req.body.website || '';\n    user.save(function(err) {\n      if (err) {\n        return next(err);\n      }\n      req.flash('success', { msg: 'Profile information updated.' });\n      res.redirect('/account');\n    });\n  });\n};\n\n/**\n * POST /account/password\n * Update current password.\n */\nexports.postUpdatePassword = function(req, res, next) {\n  req.assert('password', 'Password must be at least 4 characters long').len(4);\n  req.assert('confirmPassword', 'Passwords do not match').equals(req.body.password);\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.redirect('/account');\n  }\n\n  User.findById(req.user.id, function(err, user) {\n    if (err) {\n      return next(err);\n    }\n    user.password = req.body.password;\n    user.save(function(err) {\n      if (err) {\n        return next(err);\n      }\n      req.flash('success', { msg: 'Password has been changed.' });\n      res.redirect('/account');\n    });\n  });\n};\n\n/**\n * POST /account/delete\n * Delete user account.\n */\nexports.postDeleteAccount = function(req, res, next) {\n  User.remove({ _id: req.user.id }, function(err) {\n    if (err) {\n      return next(err);\n    }\n    req.logout();\n    req.flash('info', { msg: 'Your account has been deleted.' });\n    res.redirect('/');\n  });\n};\n\n\n/**\n * POST /reset/:token\n * Process the reset password request.\n */\nexports.postReset = function(req, res, next) {\n  req.assert('password', 'Password must be at least 4 characters long.').len(4);\n  req.assert('confirm', 'Passwords must match.').equals(req.body.password);\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.redirect('back');\n  }\n\n  async.waterfall([\n    function(done) {\n      User\n        .findOne({ passwordResetToken: req.params.token })\n        .where('passwordResetExpires').gt(Date.now())\n        .exec(function(err, user) {\n          if (err) {\n            return next(err);\n          }\n          if (!user) {\n            req.flash('errors', { msg: 'Password reset token is invalid or has expired.' });\n            return res.redirect('back');\n          }\n          user.password = req.body.password;\n          user.passwordResetToken = undefined;\n          user.passwordResetExpires = undefined;\n          user.save(function(err) {\n            if (err) {\n              return next(err);\n            }\n            req.logIn(user, function(err) {\n              done(err, user);\n            });\n          });\n        });\n    },\n    function(user, done) {\n      var transporter = nodemailer.createTransport({\n        service: 'SendGrid',\n        auth: {\n          user: process.env.SENDGRID_USER,\n          pass: process.env.SENDGRID_PASSWORD\n        }\n      });\n      var mailOptions = {\n        to: user.email,\n        from: 'hackathon@starter.com',\n        subject: 'Your Hackathon Starter password has been changed',\n        text: 'Hello,\\n\\n' +\n          'This is a confirmation that the password for your account ' + user.email + ' has just been changed.\\n'\n      };\n      transporter.sendMail(mailOptions, function(err) {\n        req.flash('success', { msg: 'Success! Your password has been changed.' });\n        done(err);\n      });\n    }\n  ], function(err) {\n    if (err) {\n      return next(err);\n    }\n    res.redirect('/');\n  });\n};\n\n/**\n * POST /forgot\n * Create a random token, then the send user an email with a reset link.\n */\nexports.postForgot = function(req, res, next) {\n  req.assert('email', 'Please enter a valid email address.').isEmail();\n\n  var errors = req.validationErrors();\n\n  if (errors) {\n    req.flash('errors', errors);\n    return res.redirect('/forgot');\n  }\n\n  async.waterfall([\n    function(done) {\n      crypto.randomBytes(16, function(err, buf) {\n        var token = buf.toString('hex');\n        done(err, token);\n      });\n    },\n    function(token, done) {\n      User.findOne({ email: req.body.email.toLowerCase() }, function(err, user) {\n        if (!user) {\n          req.flash('errors', { msg: 'No account with that email address exists.' });\n          return res.redirect('/forgot');\n        }\n        user.passwordResetToken = token;\n        user.passwordResetExpires = Date.now() + 3600000; // 1 hour\n        user.save(function(err) {\n          done(err, token, user);\n        });\n      });\n    },\n    function(token, user, done) {\n      var transporter = nodemailer.createTransport({\n        service: 'SendGrid',\n        auth: {\n          user: process.env.SENDGRID_USER,\n          pass: process.env.SENDGRID_PASSWORD\n        }\n      });\n      var mailOptions = {\n        to: user.email,\n        from: 'hackathon@starter.com',\n        subject: 'Reset your password on Hackathon Starter',\n        text: 'You are receiving this email because you (or someone else) have requested the reset of the password for your account.\\n\\n' +\n          'Please click on the following link, or paste this into your browser to complete the process:\\n\\n' +\n          'http://' + req.headers.host + '/reset/' + token + '\\n\\n' +\n          'If you did not request this, please ignore this email and your password will remain unchanged.\\n'\n      };\n      transporter.sendMail(mailOptions, function(err) {\n        req.flash('info', { msg: 'An e-mail has been sent to ' + user.email + ' with further instructions.' });\n        done(err, 'done');\n      });\n    }\n  ], function(err) {\n    if (err) {\n      return next(err);\n    }\n    res.redirect('/forgot');\n  });\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ../server/controllers/user.js\n **/","module.exports = require(\"async\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"async\"\n ** module id = 39\n ** module chunks = 0\n **/","module.exports = require(\"nodemailer\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"nodemailer\"\n ** module id = 40\n ** module chunks = 0\n **/"],"sourceRoot":""}